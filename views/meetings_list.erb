<h1 class="text-2xl font-bold text-gray-800 mb-6">äºˆå®šä¸€è¦§</h1>

<!-- äºˆå®šä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œï¼‰ -->
<div class="overflow-x-auto w-full">
  <table class="min-w-[600px] w-full table-auto border border-gray-300 shadow-sm rounded-lg bg-white">
    <thead class="bg-blue-600 text-white">
      <tr>
        <th class="px-4 py-2">ã‚¿ã‚¤ãƒˆãƒ«</th>
        <th class="px-4 py-2">èª¬æ˜</th>
        <th class="px-4 py-2 text-center">é–‹å‚¬æ—¥æ™‚</th>
        <th class="px-4 py-2 text-center">ç· åˆ‡æ—¥æ™‚</th>
        <th class="px-4 py-2 text-center">æ“ä½œ</th>
      </tr>
    </thead>
    <tbody>
      <% @meetings.each do |meeting| %>
        <% status_class = case status?(meeting.id)
          when 'attending' then 'bg-green-50'
          when 'absent' then 'bg-red-50'
          else 'bg-gray-100'
        end %>
        <tr class="border-t <%= status_class %> hover:bg-yellow-50 transition">
          <td class="px-4 py-2 font-medium text-gray-900"><%= meeting.title %></td>
          <td class="px-4 py-2 text-gray-700"><%= meeting.description %></td>
          <td class="px-4 py-2 text-center"><%= meeting.scheduled_at.strftime('%Y-%m-%d %H:%M') %></td>
          <td class="px-4 py-2 text-center"><%= meeting.deadline_at.strftime('%Y-%m-%d %H:%M') %></td>
          <td class="px-4 py-2 text-center">
            <a href="<%= request.script_name %>/org/meetings/<%= meeting.id %>"
               class="text-blue-600 hover:underline font-semibold">è©³ç´°</a>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<!-- å‡ºæ¬ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å‡¡ä¾‹ -->
<div class="mt-6 flex flex-wrap gap-4 text-sm text-gray-700">
  <div class="flex items-center gap-2">
    <div class="w-4 h-4 bg-green-200 border border-green-500 rounded-sm"></div> å‡ºå¸­
  </div>
  <div class="flex items-center gap-2">
    <div class="w-4 h-4 bg-red-200 border border-red-500 rounded-sm"></div> æ¬ å¸­
  </div>
  <div class="flex items-center gap-2">
    <div class="w-4 h-4 bg-gray-300 border border-gray-500 rounded-sm"></div> æœªå®š
  </div>
</div>

<!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ•ã‚©ãƒ¼ãƒ  -->
<form method="get" action="<%= request.script_name %>/org/meetings/all" class="mb-6 space-y-4 bg-gray-50 p-4 rounded-lg shadow">
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <input type="text" name="keyword" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢"
           value="<%= params[:keyword] %>"
           class="px-4 py-2 border border-gray-300 rounded-md">

    <input type="date" name="from" value="<%= params[:from] %>"
           class="px-4 py-2 border border-gray-300 rounded-md">

    <input type="date" name="to" value="<%= params[:to] %>"
           class="px-4 py-2 border border-gray-300 rounded-md">
  </div>

  <div class="mt-2">
    <button type="submit"
            class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition">
      çµã‚Šè¾¼ã‚€
    </button>
    <a href="<%= request.script_name %>/org/meetings/all"
       class="ml-4 text-gray-600 underline">ãƒªã‚»ãƒƒãƒˆ</a>
  </div>
</form>

<!-- äºˆå®šè¿½åŠ  -->
<% if organizer? %>
  <div class="mt-8">
    <a href="<%= request.script_name %>/org/meetings/new"
       class="inline-block bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded shadow">
      ï¼‹ æ–°ã—ã„äºˆå®šã‚’ä½œæˆ
    </a>
  </div>
<% end %>

<!-- iCalå…¬é–‹URL -->
<div class="mt-8">
  <p class="text-sm text-gray-600">ğŸ“… å…¬é–‹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼URLï¼ˆiCalï¼‰:</p>
  <input type="text" id="ical_url"
         value="<%= request.base_url %><%= request.script_name %>/org/<%= current_organization.id %>/<%= current_organization.ical_token %>.ics"
         readonly onclick="copyToClipboard()"
         class="w-full mt-1 px-3 py-2 border border-gray-300 rounded bg-gray-50 text-sm font-mono">
</div>

<script>
  function copyToClipboard() {
    const input = document.getElementById("ical_url");
    input.select();
    input.setSelectionRange(0, 99999);
    document.execCommand("copy");
    alert("URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
  }
</script>
